# 12.React哲学

> 本文目的：通过React构建一个可搜索的产品数据表格，来更深刻地领会React哲学。

#### 1、从设计稿开始

- 效果图：

  ![thinking-in-react-mock](..\images\thinking-in-react-mock.png)

- JSON API返回以下数据：

  ```javascript
  [
    {category: "Sporting Goods", price: "$49.99", stocked: true, name: "Football"},
    {category: "Sporting Goods", price: "$9.99", stocked: true, name: "Baseball"},
    {category: "Sporting Goods", price: "$29.99", stocked: false, name: "Basketball"},
    {category: "Electronics", price: "$99.99", stocked: true, name: "iPod Touch"},
    {category: "Electronics", price: "$399.99", stocked: false, name: "iPhone 5"},
    {category: "Electronics", price: "$199.99", stocked: true, name: "Nexus 7"}
  ];
  ```

  

#### 2、第一步：将设计好的 UI 划分为组件层级

- 首先，在设计稿上圈出每个组件（以及组件的子组件），并以合适的名称命名。
- 如何确定将哪些组件划分到一个组件中？
  - 可以将组件当作一种函数或者对象来考虑，根据单一功能原则来判定组件的范围。
  - 一个组件原则上只能负责一个功能。

![thinking-in-react-components](..\images\thinking-in-react-components.png)

- 上图包含五个组件：
  - 1.橙色（FilterableProductTable）：*整个示例应用的整体*
  - 2.蓝色（SearchBar）：*用户输入*
  - 3.绿色（ProductTable）：*数据内容*
  - 4.天蓝色（ProductCategoryRow）：*产品类别*
  - 5.红色（ProductRow）：*产品*
- 更加清晰的层级【设计稿中被其他组件包含的子组件，在层级上应该作为其子节点】
  - FilterableProductTable
    - SearchBar
    - ProductTable
      - ProductCategoryRow
      - ProductRow

#### 3、第二步：用 React 创建一个静态版本

- 先用已有的数据模型，渲染一个不包含交互功能的UI

- 自上而下或者自下而上构建应用

  - 自上而下
    - 先编写层级较高的组件
    - 适用于比较简单的应用
  - 自下而上
    - 从最基本的组件开始编写
    - 便于大型项目为低层组件编写测试

- 代码：

  ```
  <script type="text/babel">
    // JSON API
    const api = [
      {category: "Sporting Goods", price: "$49.99", stocked: true, name: "Football"},
      {category: "Sporting Goods", price: "$9.99", stocked: true, name: "Baseball"},
      {category: "Sporting Goods", price: "$29.99", stocked: false, name: "Basketball"},
      {category: "Electronics", price: "$99.99", stocked: true, name: "iPod Touch"},
      {category: "Electronics", price: "$399.99", stocked: false, name: "iPhone 5"},
      {category: "Electronics", price: "$199.99", stocked: true, name: "Nexus 7"}
    ]
  
    // 5.产品
    function ProductRow (props) {
      return (
        <tr class="product-row">
          <td>Football</td>
          <td>$49.99</td>
        </tr>
      )
    }
  
    // 4.产品类别
    function ProductCategoryRow (props) {
      return (
        <tr class="product-category-row">
          <th colspan="2">Sporting Goods</th>
        </tr>
      )
    }
  
    // 3.数据内容
    function ProductTable (props) {
      return (
        <table class="product-table">
          <tr>
            <th>Name</th>
            <th>Price</th>
          </tr>
          <ProductCategoryRow />
          <ProductRow />
        </table>
      )
    }
  
    // 2.用户输入
    function SearchBar (props) {
      return (
        <div class="search-bar">
          <input type="text" name="keyword" placeholder="Search..." class="keyword" />
          <br/>
          <label>
            <input type="checkbox" name="stockProduct" />
            Only show products in stock
          </label>
        </div>
      )
    }
  
    // 1.示例整体
    class FilterableProductTable extends React.Component {
      constructor (props) {
        super(props)
      }
  
      render () {
        return (
          <div class="filterable-product-table">
            <SearchBar />
            <ProductTable />
          </div>
        )
      }
    }
  
    ReactDOM.render(
      <FilterableProductTable />,
      document.getElementById('root')
    )
  </script>
  ```

  ```css
  <style>
    .filterable-product-table {
      width: 240px;
      border: 1px solid silver;
      padding: 20px;
      margin: 100px;
      font-size: 14px;
    }
    .search-bar {
      line-height: 30px;
    }
    .search-bar .keyword {
      width: 100%;
      height: 30px;
      border: 1px solid #ddd;
      text-indent: 10px;
    }
    .product-table {
      margin-top: 15px;
      width: 100%;
      text-align: left;
      line-height: 30px;
    }
    .product-category-row {
      color: #555;
    }
    .product-row {
      line-height: 20px;
    }
  </style>
  ```

  ![1586621540501](..\images\1586621540501.png)

- React **单向数据流**（也叫*单向绑定*）的思想使得组件模块化，易于快速开发。